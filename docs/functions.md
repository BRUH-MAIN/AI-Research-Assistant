| schema | function_name                    | return_type                                                                                                                                                                                                                                                                                                                                                         | arguments                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | description                                                                       |
| ------ | -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------- |
| public | activate_user                    | json                                                                                                                                                                                                                                                                                                                                                                | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Activates a user account                                                          |
| public | add_group_member                 | json                                                                                                                                                                                                                                                                                                                                                                | p_group_id integer, p_user_id integer, p_role text DEFAULT 'member'::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Adds a user to a group with specified role                                        |
| public | add_paper_to_session             | json                                                                                                                                                                                                                                                                                                                                                                | p_session_id integer, p_paper_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Links a paper to a session (fixed schema)                                         |
| public | add_session_participant          | json                                                                                                                                                                                                                                                                                                                                                                | p_session_id integer, p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Adds a user to a session                                                          |
| public | can_user_access_group            | boolean                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer, p_group_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Checks if user can access a group                                                 |
| public | can_user_access_session          | boolean                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer, p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Checks if user can access a session                                               |
| public | can_user_invoke_ai               | boolean                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer, p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Checks if user can invoke AI in a session based on role and permissions           |
| public | can_user_modify_resource         | boolean                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer, p_resource_type text, p_resource_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Checks if user can modify a resource                                              |
| public | check_group_creation_permissions | trigger                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Trigger function to check group creation permissions                              |
| public | cleanup_old_presence             | void                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Removes old offline presence records                                              |
| public | create_ai_metadata               | TABLE(ai_metadata_id integer, session_id integer, message_id integer, model_name character varying, prompt_tokens integer, completion_tokens integer, total_tokens integer, response_time_ms integer, metadata jsonb, created_at timestamp without time zone)                                                                                                       | p_session_id integer, p_message_id integer DEFAULT NULL::integer, p_model_name character varying DEFAULT 'gpt-3.5-turbo'::character varying, p_prompt_tokens integer DEFAULT 0, p_completion_tokens integer DEFAULT 0, p_total_tokens integer DEFAULT 0, p_response_time_ms integer DEFAULT 0, p_metadata jsonb DEFAULT '{}'::jsonb                                                                                                                                                                                                                                      | Creates AI processing metadata entry                                              |
| public | create_arxiv_paper               | TABLE(paper_id integer, title text, abstract text, authors text, arxiv_id text, categories text[], published_at timestamp without time zone, updated_at_source timestamp without time zone, source_url text, pdf_url text, doi text, journal_ref text, comment text, entry_id text, created_at timestamp without time zone)                                         | p_title text, p_abstract text DEFAULT NULL::text, p_authors text DEFAULT NULL::text, p_arxiv_id text DEFAULT NULL::text, p_categories text[] DEFAULT NULL::text[], p_published_at timestamp without time zone DEFAULT NULL::timestamp without time zone, p_updated_at_source timestamp without time zone DEFAULT NULL::timestamp without time zone, p_source_url text DEFAULT NULL::text, p_pdf_url text DEFAULT NULL::text, p_doi text DEFAULT NULL::text, p_journal_ref text DEFAULT NULL::text, p_comment text DEFAULT NULL::text, p_entry_id text DEFAULT NULL::text | Creates a new arXiv paper entry                                                   |
| public | create_feedback                  | TABLE(feedback_id integer, user_id integer, session_id integer, message_id integer, feedback_type character varying, rating integer, comment text, metadata jsonb, created_at timestamp without time zone)                                                                                                                                                          | p_user_id integer, p_session_id integer DEFAULT NULL::integer, p_message_id integer DEFAULT NULL::integer, p_feedback_type character varying DEFAULT 'general'::character varying, p_rating integer DEFAULT NULL::integer, p_comment text DEFAULT ''::text, p_metadata jsonb DEFAULT '{}'::jsonb                                                                                                                                                                                                                                                                         | Creates a new feedback entry                                                      |
| public | create_group                     | json                                                                                                                                                                                                                                                                                                                                                                | p_name text, p_created_by integer, p_description text DEFAULT ''::text, p_is_public boolean DEFAULT false                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Creates a new group with invite code                                              |
| public | create_group_chat_session        | TABLE(session_id integer, topic text, status character varying, started_at timestamp without time zone)                                                                                                                                                                                                                                                             | p_group_id integer, p_created_by integer, p_topic text DEFAULT 'Group Chat Session'::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Creates simple group chat session                                                 |
| public | create_group_chat_session        | TABLE(session_id integer, title text, description text, status character varying, created_at timestamp without time zone)                                                                                                                                                                                                                                           | p_group_id integer, p_created_by integer, p_title text DEFAULT 'Group Chat Session'::text, p_description text DEFAULT ''::text                                                                                                                                                                                                                                                                                                                                                                                                                                           | Creates group chat session with title and description                             |
| public | create_message                   | TABLE(message_id integer, session_id integer, sender_id integer, sender_name text, content text, sent_at timestamp without time zone)                                                                                                                                                                                                                               | p_session_id integer, p_sender_user_id integer, p_content text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Creates a new message in a session                                                |
| public | create_paper                     | TABLE(paper_id integer, title text, authors text, abstract text, url text, pdf_path text, tags text[], publish_date date, journal text, doi text, created_at timestamp without time zone)                                                                                                                                                                           | p_title text, p_authors text, p_abstract text DEFAULT ''::text, p_url text DEFAULT ''::text, p_pdf_path text DEFAULT ''::text, p_tags text[] DEFAULT '{}'::text[], p_publish_date date DEFAULT NULL::date, p_journal text DEFAULT ''::text, p_doi text DEFAULT ''::text                                                                                                                                                                                                                                                                                                  | Creates a new research paper entry                                                |
| public | create_session                   | TABLE(id integer, title text, description text, created_by integer, group_id integer, created_at timestamp without time zone, started_at timestamp without time zone, ended_at timestamp without time zone, status text, participant_count bigint)                                                                                                                  | p_title text, p_user_id integer, p_group_id integer DEFAULT 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Creates a new session with title and user                                         |
| public | create_session                   | TABLE(id integer, title text, description text, created_by integer, group_id integer, created_at timestamp without time zone, started_at timestamp without time zone, ended_at timestamp without time zone, status character varying, participant_count bigint)                                                                                                     | p_group_id integer, p_created_by integer, p_topic text DEFAULT NULL::text, p_status character varying DEFAULT 'active'::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                | Creates a new session with group and creator                                      |
| public | create_user                      | TABLE(id integer, name text, email text, is_active boolean)                                                                                                                                                                                                                                                                                                         | p_email text, p_first_name text DEFAULT NULL::text, p_last_name text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Creates a new user account                                                        |
| public | current_user_id                  | integer                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Gets current user ID from auth context                                            |
| public | deactivate_user                  | json                                                                                                                                                                                                                                                                                                                                                                | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Deactivates a user account                                                        |
| public | delete_ai_metadata               | boolean                                                                                                                                                                                                                                                                                                                                                             | p_ai_metadata_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Permanently deletes AI metadata                                                   |
| public | delete_feedback                  | boolean                                                                                                                                                                                                                                                                                                                                                             | p_feedback_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Permanently deletes feedback                                                      |
| public | delete_message                   | boolean                                                                                                                                                                                                                                                                                                                                                             | p_message_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Permanently deletes a message                                                     |
| public | delete_paper                     | boolean                                                                                                                                                                                                                                                                                                                                                             | p_paper_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Permanently deletes a paper                                                       |
| public | delete_session                   | boolean                                                                                                                                                                                                                                                                                                                                                             | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Permanently deletes a session                                                     |
| public | delete_user                      | boolean                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Permanently deletes a user                                                        |
| public | generate_invite_code             | text                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Generates a random 8-character invite code                                        |
| public | generate_secure_token            | text                                                                                                                                                                                                                                                                                                                                                                | p_length integer DEFAULT 32                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Generates a secure random token                                                   |
| public | get_ai_metadata_by_id            | TABLE(ai_metadata_id integer, session_id integer, session_title text, message_id integer, model_name character varying, prompt_tokens integer, completion_tokens integer, total_tokens integer, response_time_ms integer, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                           | p_ai_metadata_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Retrieves AI metadata details by ID                                               |
| public | get_ai_model_performance_stats   | TABLE(model_name character varying, total_requests bigint, avg_prompt_tokens numeric, avg_completion_tokens numeric, avg_total_tokens numeric, avg_response_time_ms numeric, min_response_time_ms integer, max_response_time_ms integer, total_cost_estimate numeric)                                                                                               | p_model_name character varying DEFAULT NULL::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Returns performance statistics by AI model                                        |
| public | get_ai_usage_stats               | TABLE(total_requests bigint, total_prompt_tokens bigint, total_completion_tokens bigint, total_tokens bigint, avg_response_time_ms numeric, most_used_model text, unique_sessions bigint, requests_today bigint, requests_this_week bigint, requests_this_month bigint)                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Returns overall AI usage statistics                                               |
| public | get_ai_usage_trends              | TABLE(date date, total_requests bigint, total_tokens bigint, avg_response_time_ms numeric, unique_sessions bigint, cost_estimate numeric)                                                                                                                                                                                                                           | p_days integer DEFAULT 30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Returns AI usage trends over specified days                                       |
| public | get_all_ai_metadata              | TABLE(ai_metadata_id integer, session_id integer, session_title text, message_id integer, model_name character varying, prompt_tokens integer, completion_tokens integer, total_tokens integer, response_time_ms integer, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                           | p_limit integer DEFAULT 100, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Returns all AI metadata with pagination                                           |
| public | get_all_feedback                 | TABLE(feedback_id integer, user_id integer, user_name text, session_id integer, session_title text, message_id integer, feedback_type character varying, rating integer, comment text, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                              | p_feedback_type character varying DEFAULT NULL::character varying, p_limit integer DEFAULT 50, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                | Returns all feedback with optional type filtering                                 |
| public | get_all_groups                   | TABLE(id integer, name text, description text, member_count bigint, created_at timestamp without time zone)                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Returns all groups with member counts                                             |
| public | get_all_messages                 | TABLE(id integer, session_id integer, sender_id integer, content text, message_type character varying, sent_at timestamp without time zone)                                                                                                                                                                                                                         | p_limit integer DEFAULT 100, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Returns all messages with pagination                                              |
| public | get_all_papers                   | TABLE(paper_id integer, title text, authors text, abstract text, url text, pdf_path text, tags text[], publish_date date, journal text, doi text, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                                                                                   | p_limit integer DEFAULT 100, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Returns all papers with pagination                                                |
| public | get_all_papers_with_arxiv        | TABLE(paper_id integer, title text, abstract text, authors text, arxiv_id text, categories text[], published_at timestamp without time zone, updated_at_source timestamp without time zone, source_url text, pdf_url text, doi text, journal_ref text, comment text, entry_id text, created_at timestamp without time zone, updated_at timestamp without time zone) | p_limit integer DEFAULT 100, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Returns all arXiv papers with pagination                                          |
| public | get_all_sessions                 | TABLE(id integer, title text, description text, created_by integer, group_id integer, created_at timestamp without time zone, started_at timestamp without time zone, ended_at timestamp without time zone, status character varying, participant_count bigint)                                                                                                     | p_user_id integer DEFAULT NULL::integer, p_is_active boolean DEFAULT NULL::boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Returns all sessions with optional filtering                                      |
| public | get_all_users                    | TABLE(id integer, auth_id uuid, name text, email text, is_active boolean)                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Returns all users with basic info                                                 |
| public | get_current_user_auth            | TABLE(user_id integer, email text, first_name text, last_name text, is_active boolean, created_at timestamp without time zone, auth_id uuid)                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Returns current authenticated user information                                    |
| public | get_feedback_by_id               | TABLE(feedback_id integer, user_id integer, user_name text, session_id integer, session_title text, message_id integer, feedback_type character varying, rating integer, comment text, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                              | p_feedback_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Retrieves feedback details by ID                                                  |
| public | get_feedback_stats               | TABLE(total_feedback bigint, avg_rating numeric, rating_distribution jsonb, feedback_type_distribution jsonb, recent_feedback_count bigint)                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Returns overall feedback statistics                                               |
| public | get_feedback_trends              | TABLE(date date, total_feedback bigint, avg_rating numeric, positive_feedback bigint, negative_feedback bigint)                                                                                                                                                                                                                                                     | p_days integer DEFAULT 30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Returns feedback trends over specified number of days                             |
| public | get_group_by_id                  | TABLE(id integer, name text, description text, member_count bigint, created_at timestamp without time zone)                                                                                                                                                                                                                                                         | p_group_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Retrieves group details by ID                                                     |
| public | get_group_by_invite_code         | TABLE(group_id integer, name text, description text, invite_code character varying, is_public boolean, created_by integer, created_at timestamp without time zone, updated_at timestamp without time zone, member_count bigint, creator_name text)                                                                                                                  | p_invite_code character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Get group information by invite code for joining preview                          |
| public | get_group_by_name                | TABLE(id integer, name text)                                                                                                                                                                                                                                                                                                                                        | p_name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Retrieves group by name                                                           |
| public | get_group_chat_messages          | TABLE(message_id integer, session_id integer, sender_id integer, sender_name text, sender_user_id integer, content text, message_type character varying, metadata jsonb, sent_at timestamp without time zone, edited_at timestamp without time zone, reply_to integer)                                                                                              | p_session_id integer, p_limit integer DEFAULT 50, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Returns messages from a group chat with pagination                                |
| public | get_group_chat_sessions          | TABLE(session_id integer, title text, description text, status character varying, created_by integer, creator_name text, participant_count bigint, last_message_at timestamp without time zone, last_message_content text, created_at timestamp without time zone)                                                                                                  | p_group_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Returns all group chat sessions for a group                                       |
| public | get_group_members                | TABLE(group_id integer, member_ids integer[], member_count bigint)                                                                                                                                                                                                                                                                                                  | p_group_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Returns group member IDs and count                                                |
| public | get_group_members_detailed       | TABLE(user_id integer, name text, email text, role character varying, joined_at timestamp without time zone, is_active boolean, first_name text, last_name text)                                                                                                                                                                                                    | p_group_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Returns detailed group member information                                         |
| public | get_message_by_id                | TABLE(message_id integer, session_id integer, sender_id integer, sender_name text, content text, sent_at timestamp without time zone)                                                                                                                                                                                                                               | p_message_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Retrieves message details by ID                                                   |
| public | get_paper_by_arxiv_id            | TABLE(paper_id integer, title text, abstract text, authors text, arxiv_id text, categories text[], published_at timestamp without time zone, updated_at_source timestamp without time zone, source_url text, pdf_url text, doi text, journal_ref text, comment text, entry_id text, created_at timestamp without time zone, updated_at timestamp without time zone) | p_arxiv_id text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Retrieves arXiv paper by arXiv ID                                                 |
| public | get_paper_by_id                  | TABLE(paper_id integer, title text, authors text, abstract text, url text, pdf_path text, tags text[], publish_date date, journal text, doi text, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                                                                                   | p_paper_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Retrieves paper details by ID                                                     |
| public | get_papers_stats                 | TABLE(total_papers bigint, total_sessions_with_papers bigint, avg_papers_per_session numeric, most_common_tag text, total_unique_tags bigint)                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Returns statistics about papers and their usage                                   |
| public | get_popular_papers               | TABLE(paper_id integer, title text, authors text, abstract text, url text, pdf_path text, tags text[], publish_date date, journal text, doi text, session_count bigint, created_at timestamp without time zone)                                                                                                                                                     | p_limit integer DEFAULT 20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Returns papers ordered by session usage count                                     |
| public | get_rating_stats_by_type         | TABLE(feedback_type character varying, total_ratings bigint, avg_rating numeric, min_rating integer, max_rating integer, rating_1 bigint, rating_2 bigint, rating_3 bigint, rating_4 bigint, rating_5 bigint)                                                                                                                                                       | p_feedback_type character varying DEFAULT NULL::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Returns rating statistics grouped by feedback type                                |
| public | get_recent_papers                | TABLE(paper_id integer, title text, authors text, abstract text, url text, pdf_path text, tags text[], publish_date date, journal text, doi text, created_at timestamp without time zone)                                                                                                                                                                           | p_limit integer DEFAULT 20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Returns recently added papers                                                     |
| public | get_session_ai_metadata          | TABLE(ai_metadata_id integer, session_id integer, message_id integer, model_name character varying, prompt_tokens integer, completion_tokens integer, total_tokens integer, response_time_ms integer, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                                               | p_session_id integer, p_limit integer DEFAULT 50, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Returns AI metadata for a specific session                                        |
| public | get_session_ai_performance       | TABLE(session_id integer, session_title text, total_ai_requests bigint, total_tokens bigint, avg_response_time_ms numeric, models_used jsonb, total_cost_estimate numeric, first_ai_request timestamp without time zone, last_ai_request timestamp without time zone)                                                                                               | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Returns AI performance summary for a session                                      |
| public | get_session_by_id                | TABLE(id integer, title text, description text, created_by integer, group_id integer, created_at timestamp without time zone, started_at timestamp without time zone, ended_at timestamp without time zone, status character varying, participant_count bigint)                                                                                                     | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Retrieves session details by ID                                                   |
| public | get_session_by_title             | TABLE(id integer, title text)                                                                                                                                                                                                                                                                                                                                       | p_title text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Retrieves session by title                                                        |
| public | get_session_feedback             | TABLE(feedback_id integer, user_id integer, user_name text, session_id integer, message_id integer, feedback_type character varying, rating integer, comment text, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                                                  | p_session_id integer, p_limit integer DEFAULT 50, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Returns all feedback for a specific session                                       |
| public | get_session_feedback_summary     | TABLE(session_id integer, session_title text, total_feedback bigint, avg_rating numeric, positive_feedback bigint, negative_feedback bigint, feedback_types jsonb, recent_feedback jsonb)                                                                                                                                                                           | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Returns comprehensive feedback summary for a session                              |
| public | get_session_messages             | TABLE(message_id integer, session_id integer, sender_id integer, sender_name text, content text, sent_at timestamp without time zone)                                                                                                                                                                                                                               | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Returns all messages in a session                                                 |
| public | get_session_online_users         | TABLE(user_id integer, username text, status character varying, last_seen timestamp without time zone)                                                                                                                                                                                                                                                              | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Returns online users in a specific session                                        |
| public | get_session_papers               | TABLE(paper_id integer, title text, abstract text, authors text, doi text, added_at timestamp without time zone)                                                                                                                                                                                                                                                    | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Retrieves papers associated with a session (fixed schema)                         |
| public | get_session_participants         | TABLE(session_id integer, participant_ids integer[], participant_count bigint)                                                                                                                                                                                                                                                                                      | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Returns session participant IDs and count                                         |
| public | get_session_summary              | TABLE(session_id integer, title text, message_count bigint, duration text, is_active boolean)                                                                                                                                                                                                                                                                       | p_session_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Returns session summary with statistics                                           |
| public | get_top_ai_usage_sessions        | TABLE(session_id integer, session_title text, total_ai_requests bigint, total_tokens bigint, avg_response_time_ms numeric, total_cost_estimate numeric, created_by integer, creator_name text, session_created_at timestamp without time zone)                                                                                                                      | p_limit integer DEFAULT 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Returns sessions with highest AI usage                                            |
| public | get_user_by_auth_id              | SETOF users                                                                                                                                                                                                                                                                                                                                                         | auth_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Retrieves user by auth UUID                                                       |
| public | get_user_by_id                   | TABLE(id integer, name text, email text, is_active boolean, first_name text, last_name text, created_at timestamp without time zone)                                                                                                                                                                                                                                | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Retrieves user details by ID                                                      |
| public | get_user_feedback                | TABLE(id integer, session_id integer, given_by integer, content text, rating integer, created_at timestamp without time zone)                                                                                                                                                                                                                                       | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Returns all feedback given by a user                                              |
| public | get_user_feedback                | TABLE(feedback_id integer, user_id integer, session_id integer, session_title text, message_id integer, feedback_type character varying, rating integer, comment text, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                                              | p_user_id integer, p_limit integer DEFAULT 50, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Returns all feedback from a specific user                                         |
| public | get_user_group_count             | integer                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Returns count of groups user belongs to                                           |
| public | get_user_groups                  | TABLE(id integer, group_id integer, name text, description text, is_public boolean, invite_code character varying, member_count bigint, user_role character varying, created_at timestamp without time zone, created_by integer)                                                                                                                                    | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Returns all groups a user belongs to                                              |
| public | get_user_permissions             | TABLE(user_id integer, can_create_groups boolean, can_invite_users boolean, can_moderate boolean, is_admin boolean, max_sessions integer, max_groups integer)                                                                                                                                                                                                       | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Returns user permissions and limits                                               |
| public | get_user_session_count           | integer                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Returns count of sessions user has access to                                      |
| public | handle_new_user                  | trigger                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Trigger function to create user profile on auth.users insert                      |
| public | handle_user_delete               | trigger                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Trigger function to handle user deletion (soft delete)                            |
| public | hash_password                    | text                                                                                                                                                                                                                                                                                                                                                                | p_password text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Hashes a password using bcrypt                                                    |
| public | join_group_by_invite_code        | json                                                                                                                                                                                                                                                                                                                                                                | p_invite_code text, p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Allows user to join group using invite code                                       |
| public | join_group_chat_session          | boolean                                                                                                                                                                                                                                                                                                                                                             | p_session_id integer, p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Allows user to join a group chat session                                          |
| public | log_auth_event                   | boolean                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer, p_event_type text, p_metadata jsonb DEFAULT '{}'::jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Logs authentication events                                                        |
| public | remove_group_member              | boolean                                                                                                                                                                                                                                                                                                                                                             | p_group_id integer, p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Removes a user from a group                                                       |
| public | remove_paper_from_session        | boolean                                                                                                                                                                                                                                                                                                                                                             | p_session_id integer, p_paper_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Removes paper from session                                                        |
| public | remove_session_participant       | boolean                                                                                                                                                                                                                                                                                                                                                             | p_session_id integer, p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Removes a user from a session                                                     |
| public | search_messages                  | TABLE(id integer, session_id integer, sender_id integer, content text, message_type character varying, sent_at timestamp without time zone)                                                                                                                                                                                                                         | p_query_text text, p_session_id integer DEFAULT NULL::integer, p_limit integer DEFAULT 50                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Searches messages by content                                                      |
| public | search_papers                    | TABLE(paper_id integer, title text, authors text, abstract text, url text, pdf_path text, tags text[], publish_date date, journal text, doi text, created_at timestamp without time zone, updated_at timestamp without time zone, relevance_score numeric)                                                                                                          | p_query text, p_limit integer DEFAULT 50, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Searches papers by query with relevance scoring                                   |
| public | search_papers_by_tags            | TABLE(paper_id integer, title text, authors text, abstract text, url text, pdf_path text, tags text[], publish_date date, journal text, doi text, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                                                                                   | p_tags text[], p_match_all boolean DEFAULT false, p_limit integer DEFAULT 50, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Searches papers by tags (any or all match)                                        |
| public | search_papers_with_arxiv         | TABLE(paper_id integer, title text, abstract text, authors text, arxiv_id text, categories text[], published_at timestamp without time zone, updated_at_source timestamp without time zone, source_url text, pdf_url text, doi text, journal_ref text, comment text, entry_id text, created_at timestamp without time zone, relevance_score numeric)                | p_query_text text, p_categories text[] DEFAULT NULL::text[], p_limit_count integer DEFAULT 20                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Searches arXiv papers by query and categories                                     |
| public | send_group_chat_message          | TABLE(message_id integer, session_id integer, sender_id integer, sender_name text, content text, message_type character varying, metadata jsonb, sent_at timestamp without time zone)                                                                                                                                                                               | p_session_id integer, p_user_id integer, p_content text, p_message_type character varying DEFAULT 'user'::character varying, p_metadata jsonb DEFAULT '{}'::jsonb                                                                                                                                                                                                                                                                                                                                                                                                        | Alternative fix: Uses CTEs, table aliases, and explicit typing to avoid ambiguity |
| public | set_group_invite_code            | trigger                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Trigger function to generate unique group invite codes                            |
| public | sync_user_profile                | trigger                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Trigger function to sync user profile on auth.users update                        |
| public | update_ai_metadata               | TABLE(ai_metadata_id integer, session_id integer, message_id integer, model_name character varying, prompt_tokens integer, completion_tokens integer, total_tokens integer, response_time_ms integer, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                                               | p_ai_metadata_id integer, p_model_name character varying DEFAULT NULL::character varying, p_prompt_tokens integer DEFAULT NULL::integer, p_completion_tokens integer DEFAULT NULL::integer, p_total_tokens integer DEFAULT NULL::integer, p_response_time_ms integer DEFAULT NULL::integer, p_metadata jsonb DEFAULT NULL::jsonb                                                                                                                                                                                                                                         | Updates AI metadata information                                                   |
| public | update_feedback                  | TABLE(feedback_id integer, user_id integer, session_id integer, message_id integer, feedback_type character varying, rating integer, comment text, metadata jsonb, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                                                                  | p_feedback_id integer, p_rating integer DEFAULT NULL::integer, p_comment text DEFAULT NULL::text, p_metadata jsonb DEFAULT NULL::jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                   | Updates feedback information                                                      |
| public | update_message                   | TABLE(id integer, session_id integer, sender_id integer, content text, message_type character varying, sent_at timestamp without time zone, edited_at timestamp without time zone)                                                                                                                                                                                  | p_message_id integer, p_content text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Updates message content                                                           |
| public | update_paper                     | TABLE(paper_id integer, title text, authors text, abstract text, url text, pdf_path text, tags text[], publish_date date, journal text, doi text, created_at timestamp without time zone, updated_at timestamp without time zone)                                                                                                                                   | p_paper_id integer, p_title text DEFAULT NULL::text, p_authors text DEFAULT NULL::text, p_abstract text DEFAULT NULL::text, p_url text DEFAULT NULL::text, p_pdf_path text DEFAULT NULL::text, p_tags text[] DEFAULT NULL::text[], p_publish_date date DEFAULT NULL::date, p_journal text DEFAULT NULL::text, p_doi text DEFAULT NULL::text                                                                                                                                                                                                                              | Updates paper information                                                         |
| public | update_papers_updated_at         | trigger                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                              |
| public | update_session                   | TABLE(id integer, title text, description text, created_by integer, group_id integer, created_at timestamp without time zone, started_at timestamp without time zone, ended_at timestamp without time zone, status text, participant_count bigint)                                                                                                                  | p_session_id integer, p_title text DEFAULT NULL::text, p_status text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Updates session title and/or status                                               |
| public | update_updated_at_column         | trigger                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Trigger function to update updated_at timestamp                                   |
| public | update_user                      | TABLE(id integer, name text, email text, is_active boolean)                                                                                                                                                                                                                                                                                                         | p_user_id integer, p_email text DEFAULT NULL::text, p_first_name text DEFAULT NULL::text, p_last_name text DEFAULT NULL::text, p_is_active boolean DEFAULT NULL::boolean                                                                                                                                                                                                                                                                                                                                                                                                 | Updates user information                                                          |
| public | update_user_last_seen            | trigger                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Trigger function to update last_seen timestamp                                    |
| public | update_user_presence             | boolean                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer, p_session_id integer, p_status character varying DEFAULT 'online'::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Updates user presence status in a session                                         |
| public | verify_password                  | boolean                                                                                                                                                                                                                                                                                                                                                             | p_password text, p_hash text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Verifies a password against its hash                                              |
| public | verify_user_auth                 | boolean                                                                                                                                                                                                                                                                                                                                                             | p_user_id integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Verifies if user ID matches authenticated user                                    |